## Biomass {#sec:stem-biomass}

### Supply {#sec:stem-dm-supply}

In `Stem`, the biomass supply only sources from retranslocation (Fig. \@ref(fig:stem-dm-supply)). Daily retranslocation is the proportion of current storage ($W_{stem, storage}$). The default value of proportion is 0.5 since `StartGrainFill`, i.e. retranslocatable biomsss is 50% during grain filling (Fig. \@ref(fig:stem-dm-retran-factor)).


<div class="fig-input">
```{r stem-dm-retran-factor, fig.asp = 0.5, fig.cap='The fraction of stem storage which can be retranslocated in every day.'}
y_cols <- c('Wheat.Stem.DMRetranslocationFactor')
g_report %>% 
    # filter(Wheat.Phenology.Stage > 5) %>% 
    plot_report(g_xvar2, y_cols, x_lab = g_xlab2,
            y_lab = 'Fraction of stem storage ([-])')
```
</div>



<div class="fig-output">
```{r stem-dm-supply, fig.asp = 1, fig.cap='Daily biomass supply of stem.'}
y_cols <- c('Wheat.Stem.DMSupply.Fixation',
            'Wheat.Stem.DMSupply.Retranslocation',
            'Wheat.Stem.DMSupply.Reallocation')
plot_report(g_report, g_xvar, y_cols, x_lab = g_xlab, 
            y_lab = expression('Biomass supply (g biomass '~m^-2~' ground '~d^-1~')'), 
            ncol = 3)
```
</div>


### Demand {#sec:stem-dm-demand}

The daily biomass demand of `Stem` is calculated as a fraction of daily fixation (i.e. photosynthesis) from Stage 3 (`Emergence`) to Stage 6 (`Flowering time`) (Fig. \@ref(fig:stem-dm-demand-fraction)) and increases at Stage 4 (`Terminal spikelet`) (Fig. \@ref(fig:stem-dm-demand-fraction)). After `Flowering time`, no biomass allocated into stem (Fig. \@ref(fig:stem-dm-demand)).  

<div class="fig-input">
```{r stem-dm-demand-fraction, fig.asp = 0.5, fig.cap='Stem demand as a fraction of daily total fixation (i.e. photosynthesis).'}
y_cols <- c('Wheat.Stem.DMDemandFraction')
plot_report(g_report, g_xvar2, y_cols, x_lab = g_xlab, 
            y_lab = 'Fraction of total fixation ([-])')

```
</div>




<div class="fig-output">
```{r stem-dm-demand, fig.asp = 1, fig.cap='Daily biomass demand of stem for three components.'}
y_cols <- c('Wheat.Stem.DMDemand.Structural',
            'Wheat.Stem.DMDemand.Metabolic',
            'Wheat.Stem.DMDemand.Storage')
plot_report(g_report, g_xvar, y_cols, x_lab = g_xlab, 
            y_lab = expression('Biomass demand (g biomass '~m^-2~' ground '~d^-1~')'), 
            ncol = 3)
```
</div>


### Biomass dynamic {#sec:stem-dm-dynamic}

The actual allocation reflects the increase of structural component, and retranslocation of storage component (Fig. \@ref(fig:stem-dm-allocated)). `Stem` only considers the `Live` biomass (Fig. \@ref(fig:stem-dm-live), no `Dead` biomass (Fig. \@ref(fig:stem-dm-dead)).


<div class="fig-output">
```{r stem-dm-allocated, fig.asp = 1, fig.cap='Actual allocated biomass to stem for three components. The negative values of Storage indicate biomass is ratranslocated into other organs.'}
y_cols <- sprintf('Wheat.Stem.Allocated.%sWt', g_demand)
            
plot_report(g_report, g_xvar, y_cols, x_lab = g_xlab, 
            y_lab = expression('Allocated biomass (g biomass '~m^-2~' ground '~d^-1~')'),
            y_labels = g_demand, ncol = 3)

```
</div>


<div class="fig-output">
```{r stem-dm-weight, fig.asp = 1, fig.cap='Dynamic of stem dry weights for three components and total.'}
y_cols <- c(sprintf('Wheat.Stem.%sWt', g_demand), 'Wheat.StemWt')
plot_report(g_report, g_xvar, y_cols, x_lab = g_xlab, 
            y_lab = expression('Dry weight (g biomass '~m^-2~' ground '~d^-1~')'),
            y_labels = c(g_demand, 'Total'),
            ncol = 4)

```
</div>




<div class="fig-output">
```{r stem-dm-live, fig.asp = 1, fig.cap='Dynamic of stem biomass in Live pool for three components and total.'}
y_cols <- c(sprintf('Wheat.Stem.Live.%sWt', g_demand), 'Wheat.Stem.LiveWt')
plot_report(g_report, g_xvar, y_cols, x_lab = g_xlab, 
            y_lab = expression('Dry weight (g biomass '~m^-2~' ground '~d^-1~')'),
             y_labels = c(g_demand, 'Total'),
            ncol = 4)

```
</div>


<div class="fig-output">
```{r stem-dm-dead, fig.asp = 0.5, fig.cap='Dynamic of stem biomass in Dead pool for three components and total.'}
y_cols <- c(sprintf('Wheat.Stem.Dead.%sWt', g_demand), 'Wheat.Stem.DeadWt')
plot_report(g_report, g_xvar2, y_cols, x_lab = g_xlab2, 
            y_lab = expression('Dry weight (g biomass '~m^-2~' ground '~d^-1~')'),
             y_labels = c(g_demand, 'Total'),
            ncol = 4)

```
</div>


### Water soluble carbohydrate {#ses:stem-wsc}

Water soluble carbohydrates (WSC) are sugars such as fructans, sucrose, glucose and fructose which are accumulated in the stem as reserves.


In APSIM Next Gen, the WSC of stem is defined as the ratio of storage and total weights in the `Live` pool of stem.  

<div class="fig-output">
```{r stem-dm-wsc, fig.asp = 1, fig.cap='Water soluble carbohydrate in stem.'}
y_cols <- c('Wheat.Stem.Live.StorageWt')
g_report %>% 
    filter(Wheat.Phenology.Stage > 3) %>% 
    plot_report(g_xvar, y_cols, x_lab = g_xlab, 
            y_lab = expression('WSC (g biomass '~m^-2~' ground)'),
            ncol = 3)

```
</div>

